<!DOCTYPE html>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <link id="blocklycss"  data-rtl="/blb/rtlblockly.css" rel="stylesheet" href="https://pxt.azureedge.net/blob/74e437a8d1544f7298fc1ef44e7b51e47941d0aa/blockly.css" />
        <link href="https://fonts.googleapis.com/css?family=Share+Tech+Mono&display=swap" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body>
        <div class="container">
            <div class="tabs">
                <span class="tab active" onclick="swiftTab()" id="tab1">程式積木</span>
                <span class="tab" onclick="swiftTab()" id="tab2">模擬器</span>
            </div>
            <div class="tabs-content">
                <div style="position:relative;height:calc(50em);width:100%;overflow:hidden;" id="editor"></div>
                <div id="simulator" style="height: 0;"></div>
            </div>
        </div>
        <script>
            function getValue(varname)
            {
                var url = window.location.href;
                var qparts = url.split("?");
                if (qparts.length == 0){return "";}
                var query = qparts[1];
                var vars = query.split("=");
                var value = vars[1];
                return value;
                // id: _XTKRVwMbEWiW
            }
            document.getElementById("editor").innerHTML = '    <iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="https://arcade.makecode.com/---codeembed#pub:' 
            + getValue("pub") +
            '" allowfullscreen="allowfullscreen" frameborder="0" sandbox="allow-scripts allow-same-origin"></iframe>';

        </script>
    </body>
</html>

<script>
    // console.log(screen.height);
    var locker = false;
    function swiftTab(){
        document.getElementById("tab1").classList.toggle("active");
        document.getElementById("tab2").classList.toggle("active");
        var block1 = document.getElementById("editor");
        if(locker == true){
            if(document.getElementById("tab2").classList.length>1){
                document.getElementById("simulator").style = "display: flex;padding-bottom:117.6%;"
                window.scrollTo(0, block1.offsetHeight);
            }
            else{
                document.getElementById("simulator").style = "display: none;"
            }
        }
        if(document.getElementById("tab2").classList.length>1 && locker == false){
            locker = true;
            document.getElementById("simulator").style = "display: flex;padding-bottom:117.6%;"
            window.scrollTo(0, block1.offsetHeight);
            document.getElementById("simulator").innerHTML = '    <iframe style="position:absolute;top:0;left:0;width:50%;height:50%;" src="https://arcade.makecode.com/---run?id=' 
            + getValue("pub") +
            '" allowfullscreen="allowfullscreen" sandbox="allow-popups allow-forms allow-scripts allow-same-origin" frameborder="0"></iframe>';
        }
        
    }
</script>

<style>
    .tabs{
        border-bottom: 1px rgb(116, 198, 96) solid;
        height: 44px;
    }
    .tab{
        padding: 10px;
        font-size: 18px;
        width: 100px;
        text-align: center;
        height: 45px;
        line-height: 45px;
        color: rgb(116, 198, 96);
        cursor: pointer;
    }
    #tab1{
        border-radius: 4px 4px 0 0px;
    }
    #tab2{
        border-radius: 4px 4px 0px 0px;
    }
    .active{
        color: white;
        background-color: rgb(116, 198, 96);
    }

    #simulator{
        position:relative;height:0;overflow:hidden;
    }
    
</style>